SELECT rank() OVER (PARTITION BY season_id ORDER BY game_date ASC) AS game_count,
game_type AS game_type,
game_date AS game_date,
start_time AS game_start,
(CASE WHEN v_team_id = 'CHA' THEN 'Home' 
WHEN h_team_id = 'CHA' THEN 'Away' 
ELSE '' END) AS location,
attendance AS attendance,
game_time AS game_duration,
(CASE WHEN winning_team = 'CHA' THEN 'W' 
WHEN winning_team  = '' THEN 'T' ELSE 'L' END) AS  result,
(CASE WHEN h_team_id = 'CHA' THEN h_team_runs 
WHEN v_team_id = 'CHA' THEN v_team_runs
WHEN h_team_id = '' THEN h_team_runs
ELSE '' END) AS runs,
(CASE WHEN h_team_id != 'CHA' THEN h_team_runs 
WHEN v_team_id != 'CHA' THEN v_team_runs
WHEN h_team_id != '' THEN h_team_runs
ELSE '' END) AS runs_against
FROM lines_games
WHERE (v_team_id = 'CHA' OR h_team_id LIKE 'CHA')
AND season_id = 2024
ORDER BY game_date ASC
