CREATE VIEW season_p_baserunning AS 
SELECT 
a.player_id AS player_id,
a.player_name AS player_name,
a.season_id AS season_id,
a.age AS age,
SUM(a.d_sb) AS sb,
SUM(a.d_cs) AS cs,
ROUND(SUM(a.d_sb)/(SUM(d_sb)+SUM(d_cs)),2) AS sb_pct,
SUM(c.mri_p_baserunning_rc) AS mri_p_baserunning_rc,
SUM(c.mri_p_baserunning_raa) AS mri_p_baserunning_raa,
SUM(c.mri_p_baserunning_waa) AS mri_p_baserunning_waa,
SUM(c.mri_p_baserunning_war) AS mri_p_baserunning_war
FROM standard_fielding AS a
INNER JOIN rate_p_baserunning AS b
ON a.player_id = b.player_id AND a.team_id = b.team_id AND a.season_id = b.season_id
LEFT JOIN mri_preventing_baserunning AS c
ON a.player_id = c.player_id AND a.team_id = c.team_id AND a.season_id = c.season_id
GROUP BY 
a.player_id,
a.season_id;

CREATE VIEW season_p_baserunning_x_team AS 
SELECT 
a.player_id AS player_id,
a.player_name AS player_name,
a.team_id AS team_id,
a.season_id AS season_id,
a.age AS age,
a.d_sb AS sb,
a.d_cs AS cs,
b.d_sb_pct AS sb_pct,
c.mri_p_baserunning_rc AS mri_p_baserunning_rc,
c.mri_p_baserunning_raa AS mri_p_baserunning_raa,
c.mri_p_baserunning_waa AS mri_p_baserunning_waa,
c.mri_p_baserunning_war AS mri_p_baserunning_war
FROM standard_fielding AS a
INNER JOIN rate_p_baserunning AS b
ON a.player_id = b.player_id AND a.team_id = b.team_id AND a.season_id = b.season_id
LEFT JOIN mri_preventing_baserunning AS c
ON a.player_id = c.player_id AND a.team_id = c.team_id AND a.season_id = c.season_id;

CREATE VIEW career_p_baserunning AS 
SELECT 
a.player_id AS player_id,
a.player_name AS player_name,
COUNT(DISTINCT(a.season_id)) AS seasons,
MIN(a.season_id) AS first_season,
MAX(a.season_id) AS last_season,
COUNT(DISTINCT(a.team_id)) AS diff_teams,
SUM(a.d_sb) AS sb,
SUM(a.d_cs) AS cs,
ROUND(SUM(a.d_sb)/(SUM(d_sb)+SUM(d_cs)),2) AS sb_pct,
SUM(c.mri_p_baserunning_rc) AS mri_p_baserunning_rc,
SUM(c.mri_p_baserunning_raa) AS mri_p_baserunning_raa,
SUM(c.mri_p_baserunning_waa) AS mri_p_baserunning_waa,
SUM(c.mri_p_baserunning_war) AS mri_p_baserunning_war
FROM standard_fielding AS a
INNER JOIN rate_p_baserunning AS b
ON a.player_id = b.player_id AND a.team_id = b.team_id AND a.season_id = b.season_id
LEFT JOIN mri_preventing_baserunning AS c
ON a.player_id = c.player_id AND a.team_id = c.team_id AND a.season_id = c.season_id
GROUP BY 
a.player_id;

CREATE VIEW career_p_baserunning_x_team AS 
SELECT 
a.player_id AS player_id,
a.player_name AS player_name,
a.team_id,
COUNT(DISTINCT(a.season_id)) AS seasons,
MIN(a.season_id) AS first_season,
MAX(a.season_id) AS last_season,
SUM(a.d_sb) AS sb,
SUM(a.d_cs) AS cs,
ROUND(SUM(a.d_sb)/(SUM(d_sb)+SUM(d_cs)),2) AS sb_pct,
SUM(c.mri_p_baserunning_rc) AS mri_p_baserunning_rc,
SUM(c.mri_p_baserunning_raa) AS mri_p_baserunning_raa,
SUM(c.mri_p_baserunning_waa) AS mri_p_baserunning_waa,
SUM(c.mri_p_baserunning_war) AS mri_p_baserunning_war
FROM standard_fielding AS a
INNER JOIN rate_p_baserunning AS b
ON a.player_id = b.player_id AND a.team_id = b.team_id AND a.season_id = b.season_id
LEFT JOIN mri_preventing_baserunning AS c
ON a.player_id = c.player_id AND a.team_id = c.team_id AND a.season_id = c.season_id
GROUP BY 
a.player_id,
a.team_id;

CREATE VIEW season_team_p_baserunning AS 
SELECT 
a.team_id,
a.season_id,
COUNT(a.player_id) AS baserunners,
ROUND(AVG(a.age),1) AS age,
SUM(a.d_sb) AS sb,
SUM(a.d_cs) AS cs,
ROUND(SUM(a.d_sb)/(SUM(d_sb)+SUM(d_cs)),2) AS sb_pct,
SUM(c.mri_p_baserunning_rc) AS mri_p_baserunning_rc,
SUM(c.mri_p_baserunning_raa) AS mri_p_baserunning_raa,
SUM(c.mri_p_baserunning_waa) AS mri_p_baserunning_waa,
SUM(c.mri_p_baserunning_war) AS mri_p_baserunning_war
FROM standard_fielding AS a
INNER JOIN rate_p_baserunning AS b
ON a.player_id = b.player_id AND a.team_id = b.team_id AND a.season_id = b.season_id
LEFT JOIN mri_preventing_baserunning AS c
ON a.player_id = c.player_id AND a.team_id = c.team_id AND a.season_id = c.season_id
GROUP BY 
a.team_id,
a.season_id;
