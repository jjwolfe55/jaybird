CREATE VIEW player_defense_season_baserunning AS 
SELECT a.player_id,
 a.player_name,
 a.season_id,
 a.age,
 a.throw,
 SUM(a.d_g) AS g,
 SUM(a.d_gs) AS gs,
 SUM(a.d_inn) AS inn,
 SUM(a.d_sb) AS sb,
 SUM(a.d_cs) AS cs,
 SUM(c.mri_p_baserunning_rc) AS mri_rc,
 SUM(c.mri_p_baserunning_raa) AS mri_raa,
 SUM(c.mri_p_baserunning_waa) AS mri_waa,
 SUM(c.mri_p_baserunning_war) AS mri_war
FROM standard_fielding AS a
INNER JOIN rate_fielding AS b
ON a.player_id = b.player_id AND a.team_id = b.team_id AND a.season_id = b.season_id AND a.d_pos = b.d_pos
LEFT JOIN mri_preventing_baserunning AS c
ON a.player_id = c.player_id AND a.team_id = c.team_id AND a.season_id = c.season_id 
INNER JOIN lookup_team_history AS d
ON a.team_id = d.team_id 
AND a.season_id BETWEEN d.first_season AND d.last_season
WHERE a.d_pos = 'c'
GROUP BY a.player_id,a.season_id;

CREATE VIEW player_defense_season_baserunning_x_team AS 
SELECT a.player_id,
 a.player_name,
 d.franchise_id AS franchise,
 a.team_id AS team,
 d.nickname AS team_nickname,
 d.league_id AS league,
 d.division_id AS division,
 a.season_id,
 a.age,
 a.throw,
 SUM(a.d_g) AS g,
 SUM(a.d_gs) AS gs,
 SUM(a.d_inn) AS inn,
 SUM(a.d_sb) AS sb,
 SUM(a.d_cs) AS cs,
 SUM(c.mri_p_baserunning_rc) AS mri_rc,
 SUM(c.mri_p_baserunning_raa) AS mri_raa,
 SUM(c.mri_p_baserunning_waa) AS mri_waa,
 SUM(c.mri_p_baserunning_war) AS mri_war
FROM standard_fielding AS a
INNER JOIN rate_fielding AS b
ON a.player_id = b.player_id AND a.team_id = b.team_id AND a.season_id = b.season_id AND a.d_pos = b.d_pos
LEFT JOIN mri_preventing_baserunning AS c
ON a.player_id = c.player_id AND a.team_id = c.team_id AND a.season_id = c.season_id 
INNER JOIN lookup_team_history AS d
ON a.team_id = d.team_id 
AND a.season_id BETWEEN d.first_season AND d.last_season
WHERE a.d_pos = 'c'
GROUP BY a.player_id,a.season_id,a.team_id;
