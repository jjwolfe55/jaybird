LOAD DATA LOCAL INFILE "C:/ProgramData/MySQL/MySQL Server 8.0/Uploads/Jaybird/Lookup/biofile0_1901_2024.csv"
INTO TABLE lookup_player_bio
FIELDS TERMINATED BY ','
LINES TERMINATED BY '\n' 
IGNORE 1 ROWS;

LOAD DATA LOCAL INFILE "C:/ProgramData/MySQL/MySQL Server 8.0/Uploads/Jaybird/Lookup/lookup_team_history_1901_2024.csv"
INTO TABLE lookup_team_history
FIELDS TERMINATED BY ','
LINES TERMINATED BY '\n' 
IGNORE 1 ROWS;


LOAD DATA LOCAL INFILE "C:/ProgramData/MySQL/MySQL Server 8.0/Uploads/Jaybird/Lookup/lookup_linear_weights_1901_2025.csv"
INTO TABLE lookup_linear_weights
FIELDS TERMINATED BY ','
LINES TERMINATED BY '\n' 
IGNORE 1 ROWS;

LOAD DATA LOCAL INFILE "C:/ProgramData/MySQL/MySQL Server 8.0/Uploads/Jaybird/Lookup/lookup_age_date_1901_2025.csv"
INTO TABLE lookup_age_date
FIELDS TERMINATED BY ','
LINES TERMINATED BY '\n' 
IGNORE 1 ROWS;

INSERT INTO lookup_fielding_positions (
d_pos,
d_pos_id,
d_pos_name)
VALUES 
(1,'P','Pitcher'),
(2,'C','Catcher'),
(3,'1B','First Base'),
(4,'2B','Second Base'),
(5,'3B','Third Base'),
(6,'SS','Shortstop'),
(7,'LF','Left Field'),
(8,'CF','Center Field'),
(9,'RF','Right Field')
;

INSERT INTO lookup_run_environment (
season_id,
team_count,
team_runs_avg
)
SELECT a.season_id,
COUNT(DISTINCT(a.team_id)),
(b.runs_for + c.runs_against)/(COUNT(DISTINCT(a.team_id))) 
FROM standard_standings AS a
INNER JOIN (SELECT season_id, SUM(b_r) AS runs_for FROM standard_batting GROUP BY season_id) AS b
ON a.season_id = b.season_id
INNER JOIN (SELECT season_id, SUM(p_r) AS runs_against FROM standard_pitching GROUP BY season_id) AS c
ON a.season_id = c.season_id
WHERE a.season_id BETWEEN <xx> AND <yy>
GROUP BY a.season_id
ORDER BY a.season_id DESC;
